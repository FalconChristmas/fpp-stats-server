<!DOCTYPE HTML>

<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css"
        integrity="sha512-/zs32ZEJh+/EO2N1b0PEdoA10JkdC3zJ8L5FTiQu82LR9S/rOQNfQN7U59U9BC12swNeRAz3HSzIL2vpp4fv3w=="
        crossorigin="anonymous" />
    <link rel="stylesheet" href="my.css" />

    <meta name="keywords" content="Christmas Lights, Falcon Pi Player, FPP">
    <title>FPP Installations Statistics</title>

</head>

<body>
    <div id="main-div" class="container" style="padding-top: 2em">
        <h1>FPP Installations Statistics</h1>
        <div>This is a top level summary of information gather from FPP installations around the world. In unless otherwise stated
            only those installations that have submitted statistics in the last year are included.  This report was last updated
            <span id="lastUpdated"><i>Refresh has failed</i></span>.
        </div>
        <div id="loading" class="ajax-loading-60px"></div>

        <div class="row">
            <div class="chart-outer col">
                <h2>Platform</h2>
                <div class="canvas-holder">
                    <canvas id="platform365"></canvas>
                </div>
            </div>

            <div class="chart-outer col">
                <h2>FPP Mode</h2>
                <div class="canvas-holder">
                    <canvas id="fppMode365"></canvas>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="chart-outer col">
                <h2>Release</h2>
                <div class="canvas-holder">
                    <canvas id="version365"></canvas>
                </div>
            </div>

            <div class="chart-outer col">
                <h2>MQTT Configured?</h2>
                <div class="canvas-holder">
                    <canvas id="mqtt365"></canvas>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="chart-outer col">
                <h2>Installed Cape</h2>
                <div class="canvas-holder">
                    <canvas id="cape365"></canvas>
                </div>
            </div>
<!--
            <div class="chart-outer col">
                <h2>MQTT Configured?</h2>
                <div class="canvas-holder">
                    <canvas id="future365"></canvas>
                </div>
            </div>
-->
        </div>


    </div>

    <!-- All Javascript from here on out-->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"
        integrity="sha512-zO8oeHCxetPn1Hd9PdDleg5Tw1bAaP0YmNvPY8CwcRyUk7d7/+nyElmFrB6f7vg4f7Fv4sui1mcep8RIEShczg=="
        crossorigin="anonymous"></script>
    <script src="my.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            $.get("https://fppstats.thehormanns.net/api/summary"
            ).done(function (data) {
                $("#loading").hide();
                var when = new Date(data.ts).toISOString();
                $("#lastUpdated").html(when);
                console.log(data);
                drawPieChart($("#platform365"), data.platform, "last365Days");
                drawPieChart($("#fppMode365"), data.fppMode, "last365Days");
                drawPieChart($("#version365"), data.version, "last365Days");
                drawPieChart($("#mqtt365"), data.mqttEnabled, "last365Days");
                drawPieChart($("#cape365"), data.capeInstalled, "last365Days");
            }).fail(function () {
                alert("Unable to load statistics");
            })
        });
    </script>
</body>

</html>
