<!DOCTYPE HTML>

<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.css"
        integrity="sha512-/zs32ZEJh+/EO2N1b0PEdoA10JkdC3zJ8L5FTiQu82LR9S/rOQNfQN7U59U9BC12swNeRAz3HSzIL2vpp4fv3w=="
        crossorigin="anonymous" />
    <link rel="stylesheet" href="my.css" />

    <meta name="keywords" content="Christmas Lights, Falcon Pi Player, FPP">
    <title>FPP Installations Statistics</title>

</head>

<body>
    <div id="main-div" class="container" style="padding-top: 2em">
        <h1>FPP Installations Statistics</h1>
        <div>This is a top level summary of information gathered from FPP installations around the world. 
            Unless otherwise stated only those installations that have submitted statistics in the last year are included. 
            This report was last updated
            <span id="lastUpdated"><i>Refresh has failed</i></span>.
        </div>
        <div id="loading" class="ajax-loading-60px"></div>

        <div id="all-charts">
            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2># of Devices Reporting</h2>
                    <div class="canvas-holder">
                        <canvas id="lastReportChart"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>Release</h2>
                    <div class="canvas-holder">
                        <canvas id="version365"></canvas>
                    </div>
                </div>

            </div>

            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2>Platform</h2>
                    <div class="canvas-holder">
                        <canvas id="platform365"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>Generic Platform Variant</h2>
                    <div class="canvas-holder">
                        <canvas id="platformGenericVar365"></canvas>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2>Pi Platform Variant</h2>
                    <div class="canvas-holder">
                        <canvas id="platformPiVar365"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>BBB Platform Variant</h2>
                    <div class="canvas-holder">
                        <canvas id="platformBBBVar365"></canvas>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2>FPP Mode</h2>
                    <div class="canvas-holder">
                        <canvas id="fppMode365"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>Installed Cape</h2>
                    <div class="canvas-holder">
                        <canvas id="cape365"></canvas>
                    </div>
                </div>

            </div>

            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2>MQTT Configured?</h2>
                    <div class="canvas-holder">
                        <canvas id="mqtt365"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>UI Level</h2>
                    <div class="canvas-holder">
                        <canvas id="uiLevel365"></canvas>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-2"></div>
                <div class="chart-outer col-sm-8">
                    <h2>Top 10 Plugins</h2>
                    <div class="canvas-holder">
                        <canvas id="plugins365"></canvas>
                    </div>
                </div>
                <div class="col-sm-2"></div>
            </div>

            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2>E1.31 Output Universes</h2>
                    <div class="canvas-holder">
                        <canvas id="outUnivt365"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>E1.31 Output Channels</h2>
                    <div class="canvas-holder">
                        <canvas id="outChannel365"></canvas>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2>E1.31 Input Universes</h2>
                    <div class="canvas-holder">
                        <canvas id="inUnivt365"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>E1.31 Input Channels</h2>
                    <div class="canvas-holder">
                        <canvas id="inChannel365"></canvas>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="chart-outer col-sm-6">
                    <h2>Output Processors</h2>
                    <div class="canvas-holder">
                        <canvas id="outputProcessor365"></canvas>
                    </div>
                </div>
                <div class="chart-outer col-sm-6">
                    <h2>Popular Settings</h2>
                    <div class="canvas-holder">
                        <canvas id="popularSettings365"></canvas>
                    </div>
                </div>
            </div>

        </div><!-- All Charts-->
    </div>

    <!-- All Javascript from here on out-->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.bundle.js"
        integrity="sha512-zO8oeHCxetPn1Hd9PdDleg5Tw1bAaP0YmNvPY8CwcRyUk7d7/+nyElmFrB6f7vg4f7Fv4sui1mcep8RIEShczg=="
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-colorschemes"></script>
    <script src="my.js"></script>

    <script type="text/javascript">
        var timeFields = {
            fields: ["last15Days", "last30Days", "last60Days", "last180Days", "last365Days", "totalCount"],
            labels: ["Last 15 Days", "Last 30 Days", "Last 60 Days", "Last 180 Days", "Last Year", "All Time"]
        }
        $(document).ready(function () {
            $.get("https://fppstats.thehormanns.net/api/summary"
            ).done(function (data) {
                $("#loading").hide();
                $("#all-charts").show();
                var when = formatDate(new Date(data.ts));
                $("#lastUpdated").html(when);
                console.log(data);
                drawPieChart($("#platform365"), data.platform, "last365Days");
                drawPieChart($("#platformGenericVar365"), data.platformVariantBreakout.data.Generic, "last365Days");
                drawPieChart($("#platformPiVar365"), data.platformVariantBreakout.data["Raspberry Pi"], "last365Days");
                drawPieChart($("#platformBBBVar365"), data.platformVariantBreakout.data["BeagleBone Black"], "last365Days");
                drawPieChart($("#fppMode365"), data.fppMode, "last365Days");
                drawPieChart($("#version365"), data.version, "last365Days");
                drawPieChart($("#mqtt365"), data.mqttEnabled, "last365Days");
                drawPieChart($("#uiLevel365"), data.uiLevel, "last365Days");
                drawPieChart($("#cape365"), data.capeInstalled, "last365Days");
                drawBarChartObject($("#lastReportChart"), data.Instances.data, timeFields.fields, timeFields.labels);
                drawSortedBarChart($("#plugins365"), data.topPlugins.data.last365Days, 10);
                drawBarChartObjectTime($("#outUnivt365"), data.outputUniverses.data.universe, data.outputUniverses.data.universeOrder,data.outputUniverses.data.universeOrder, "last365Days");
                drawBarChartObjectTime($("#outChannel365"), data.outputUniverses.data.channel, data.outputUniverses.data.channelOrder,data.outputUniverses.data.channelOrder, "last365Days");
                drawBarChartObjectTime($("#inUnivt365"), data.inputUniverses.data.universe, data.inputUniverses.data.universeOrder,data.inputUniverses.data.universeOrder, "last365Days");
                drawBarChartObjectTime($("#inChannel365"), data.inputUniverses.data.channel, data.inputUniverses.data.channelOrder,data.inputUniverses.data.channelOrder, "last365Days");
                drawSortedBarChart($("#outputProcessor365"), data.outputProcessors.data, 10, day365Transformer);
                drawSortedBarChart($("#popularSettings365"), data.settingsPopular.data, 10, day365Transformer);
                
            }).fail(function () {
                alert("Unable to load statistics");
            })
        });
    </script>
</body>

</html>
